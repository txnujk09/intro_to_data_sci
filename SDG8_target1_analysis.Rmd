---
title: "SDG 8, Target 1 Analysis"
author: "Group C7"
output: pdf_document
---

# Introduction : Target 1

Target 1 : Sustain per capita economic growth in accordance with national circumstances and, in particular, at least 7 per cent gross domestic product growth per annum in the least developed countries.

# Data Loading and Preparation

(Here we will load: continents-according-to-our-world-in-data.csv, gdp-per-capita-worldbank.csv, youth-not-in-education-employment-training.csv)

```{r setup, message=FALSE}
library(tidyverse)
library(readr)

gdp_clean <- read_rds("../data/gdp_clean.rds")
neet_clean <- read_rds("../data/neet_clean.rds")
continents_clean <- read_rds("../data/continents_clean.rds")
ldc_clean <- read_rds("../data/ldc_clean.rds")
ldc_raw <- read_csv("../data/ldc_list.csv", show_col_types = FALSE)

source("../src/analysis_functions.R")

merged_df <- merge_all_data(gdp_clean, neet_clean, continents_clean, ldc_clean)

gdp_growth <- compute_gdp_growth(merged_df)
neet_changes <- compute_neet_changes(merged_df)
```

# Target 1 Analysis — GDP per Capita Growth

(We will compute yearly growth % for each continent.)

```{r gdp-growth-by-continent, echo=FALSE}

gdp_growth <- compute_gdp_growth(merged_df)
neet_changes <- compute_neet_changes(merged_df)
gdp_growth_plot <- gdp_growth %>%
  filter(!is.na(gdp_growth), !is.na(continent)) %>%
  group_by(continent, year) %>%
  summarise(avg_growth = mean(gdp_growth, na.rm = TRUE)) %>%
  ggplot(aes(x = `year`, y = `avg_growth`, colour = continent)) +
  geom_line(aes(group = continent), linewidth = 1)+
  xlab("Year") +
  theme(axis.text.y = element_text)+
  ylab("GDP growth rate (%) ") +
  scale_colour_manual(values = c("lightblue", "violet", "lightpink", "turquoise", "lightgreen", "orange"))+
  ggtitle("Average annual GDP per Capita Growth per continent")+
  theme_minimal()
print(gdp_growth_plot)
```

# Target 1 Analysis — GDP per Capita Growth per continent

(split the gdp per growth into different dataframes per continent)

```{r ldc-share-growth, echo=FALSE}
gdp_growth_only_ldc <-gdp_growth%>%
  select(-`gdp_pc`, -`code.y`, -`neet_rate`, -`code.x`)%>%
  filter(`is_ldc` == "TRUE")%>%
  select (- `is_ldc`)

gdp_growth_only_ldc_asia <- gdp_growth_only_ldc %>%
  filter(continent == "Asia")
gdp_growth_only_ldc_africa <- gdp_growth_only_ldc %>%
  filter(continent == "Africa")
gdp_growth_only_ldc_northamerica <- gdp_growth_only_ldc %>%
  filter(continent == "North America")
gdp_growth_only_ldc_oceania <- gdp_growth_only_ldc %>%
  filter(continent == "Oceania")
africa_grouped <- gdp_growth_only_ldc_africa%>%
  drop_na()%>%
  group_by(year) %>%
  summarise(mean_growth = mean(gdp_growth, na.rm = TRUE))
```

# Target 1 Analysis — growth of LDCs per continent

(plot the graphs for the LDCs of each continent. There is an extra graph with the average growth rate for all the LDCs in Africa since there are 26 LDCs in Africa and the graph is quite messy. The red dashed line indicates the 7 percent growth target.)

```{r LDC-GDP-growth-by-continent, echo=FALSE}
gdp_growth_only_ldc_asia_plot <- gdp_growth_only_ldc_asia %>%
  ggplot(aes(x = `year`, y = `gdp_growth`, colour = country)) +
  geom_line(aes(group = country))+
  geom_hline(yintercept = 7, colour = "red", linewidth = 1, linetype = "dashed")+
  xlab("Year") +
  theme(axis.text.y = element_text)+
  ylab("GDP growth rate (%) ") +
  scale_colour_manual(values = c("lightblue", "violet", "lightpink", "turquoise", "lightgreen", "orange"))+
  ggtitle("Average annual GDP per Capita Growth for Asia's LDCs")+
  theme_minimal()
print(gdp_growth_only_ldc_asia_plot)




gdp_growth_only_ldc_africa_plot <- gdp_growth_only_ldc_africa %>%
  ggplot(aes(x = `year`, y = `gdp_growth`, colour = country)) +
  geom_line(aes(group = country))+
  geom_hline(yintercept = 7, colour = "red", linewidth = 1, linetype = "dashed")+
  xlab("Year") +
  theme(axis.text.y = element_text)+
  ylab("GDP growth rate (%) ") +
  scale_colour_manual(values = c("lightblue", "violet", "lightpink", "turquoise", "lightgreen", "orange", "darkblue", "darkgreen", "darkred",
                                 "darkkhaki", "grey", "beige", "magenta", "darkslateblue", "deeppink4", "chocolate4", "coral", "deepskyblue4", "darkorchid3",
                                 "darkseagreen2", "darkseagreen4", "darkgoldenrod2", "cyan3", "cornflowerblue", "blueviolet", "azure3"))+
  ggtitle("Average annual GDP per Capita Growth for Africa's LDCs")+
  theme_minimal()

print(gdp_growth_only_ldc_africa_plot)

africa_grouped_plot <- africa_grouped %>%
  ggplot(aes(x = `year`, y = `mean_growth`)) +
  geom_line(colour = "darkseagreen", linewidth = 1)+
  geom_hline(yintercept = 7, colour = "red", linewidth = 1, linetype = "dashed")+
  xlab("Year") +
  theme(axis.text.y = element_text)+
  ylab("GDP growth rate (%) ") +
  ggtitle("Average annual GDP per Capita Growth for Africa's LDCs")+
  theme_minimal()
print(africa_grouped_plot)



gdp_growth_only_ldc_northamerica_plot <- gdp_growth_only_ldc_northamerica %>%
  ggplot(aes(x = `year`, y = `gdp_growth`, colour = country)) +
  geom_line(aes(group = country))+
  geom_hline(yintercept = 7, colour = "red", linewidth = 1, linetype = "dashed")+
  xlab("Year") +
  theme(axis.text.y = element_text)+
  ylab("GDP growth rate (%) ") +
  scale_colour_manual(values = c("lightblue"))+
  ggtitle("Average annual GDP per Capita Growth for North America's LDCs")+
  theme_minimal()
print(gdp_growth_only_ldc_northamerica_plot)


gdp_growth_only_ldc_oceania_plot <- gdp_growth_only_ldc_oceania %>%
  ggplot(aes(x = `year`, y = `gdp_growth`, colour = country)) +
  geom_line(aes(group = country))+
  geom_hline(yintercept = 7, colour = "red", linewidth = 1, linetype = "dashed")+
  xlab("Year") +
  theme(axis.text.y = element_text)+
  ylab("GDP growth rate (%) ") +
  scale_colour_manual(values = c("lightblue", "violet"))+
  ggtitle("Average annual GDP per Capita Growth for Oceania's LDCs")+
  theme_minimal()
print(gdp_growth_only_ldc_oceania_plot)


```
